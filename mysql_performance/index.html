<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <script src="index_files/tigris.txt" type="text/javascript"></script>
  <link rel="stylesheet" type="text/css" href="index_files/netbeans.css">
  <title>LAB-1627: MySQL Performance</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <meta name="SourceCastVersion" content="2.6.2.4.10">
  <link rel="shortcut icon" href="http://www.netbeans.org/favicon.ico"
 type="image/x-icon">
  <meta name="keywords"
 content="NetBeans, IDE, Platform, free, open source, developer">
  <link rel="stylesheet" href="index_files/netbeans_002.css">
  <meta name="author" content="Sang Shin">
  <style type="text/css">
#search {height:100%;}
#topmodule {align:right;}
  </style>
  <script language="JavaScript" type="text/javascript">
<!--
function get_sc_login() {
  var sclogin = "guest";
  return (sclogin);
}
var username=get_sc_login();
//-->
  </script>
</head>
<body onload="loginfocus()" class="composite">
<!-- begin TopTabs --><!-- end TopTabs --><!-- start NavCol --><!-- end NavCol --><!-- Servlet-Specific template --><!-- Show servlet name if it is a servlet -->
<br>
<br>
<h1 style="text-align: center;">MySQL Performance<br>
</h1>
<div class="articledate" style="margin-left: 0px; text-align: center;"><a
 href="http://www.javapassion.com/SangSchedule.html#Bio">Sang Shin</a>,
<a href="http://www.javapassion.com">www.javapassion.com</a><a
 href="mailto:sangshinpassion@gmail.com"><i>
</i></a></div>
<div class="indent"><br>
<div style="text-align: center;"><img alt=""
 src="index_files/sangshin2009.jpg" style="width: 88px; height: 101px;"><br>
</div>
<br>
MySQL is known for its high performance.&nbsp; Yet, performance does
not come automatically.&nbsp; Fortunately MySQL provides enough tunning
opportunities for achieving high performance.<br>
<br>
<b><br>
</b>
<div style="text-align: center;"><b>Expected duration: 90 minutes
(excluding homework)<br>
<br>
</b></div>
<br>
<br>
<h3 class="tutorial">Software Needed</h3>
<br>
Before you begin, you need to install the following software.
<ul>
  <li>MySQL (<a href="http://dev.mysql.com/downloads/">download</a>)</li>
</ul>
<h3 class="tutorial">OS platforms you can use<br>
</h3>
<ul>
  <li>Windows</li>
  <li>Solaris x86, Solaris Sparc</li>
  <li>Linux</li>
  <li>Mac OS X</li>
</ul>
<h3 class="tutorial"><a name="Change_Log"></a>Change Log<br>
</h3>
<ul>
  <li>March 15th, 2010: Created<br>
  </li>
</ul>
<br>
<h3 class="tutorial">Things to be done (by Sang Shin)<br>
</h3>
<ul>
  <li>Add more exercises <br>
  </li>
</ul>
&nbsp;
<br>
<h3 class="tutorial"><a name="Tutorial_Exercises"></a>Lab Exercises</h3>
<ul>
  <li><a href="#Exercise_1">Exercise 1: Query optimizaiton - Caching
(30
minutes)</a></li>
  <li><a href="#Exercise_2">Exercise 2: Query optimization - Indexing
(30 minutes)</a></li>
  <li><a href="#Exercise_3">Exercise 3: EXPLAIN (30 minutes)</a><br>
  </li>
  <li><a href="#Exercise_3">Exercise 4: Slow Query Log (30 minutes)<br>
    </a></li>
  <li><a href="#Homework_Exercise">Homework
Exercise (for people who
are taking Sang Shin's MySQL online course")</a></li>
</ul>
</div>
<br>
<h2><a name="Exercise_1"></a>Exercise 1: Query optmization - Caching<br>
</h2>
<p style="margin-left: 40px;"> The query cache stores the text of a <code
 class="literal">SELECT</code> statement together with the
corresponding result that was sent to the client. If an identical
statement is received later, the server retrieves the results from the
query cache rather than parsing and executing the statement again. The
query cache is shared among sessions, so a result set generated by one
client can be sent in response to the same query issued by another
client. </p>
<p style="margin-left: 40px;"> The query cache is extremely useful in
an environment where you have tables that do not change very often and
for which the server receives many identical queries. This is a typical
situation for many Web servers that generate many dynamic pages based
on database content. </p>
<p style="margin-left: 40px;"> The query cache does not return stale
data. When tables are modified, any relevant entries in the query cache
are flushed.&nbsp; <br>
</p>
<p style="margin-left: 40px;">For further information, read <a
 href="http://dev.mysql.com/doc/refman/5.1/en/query-cache.html">MySQL
Query Cache</a> document.<br>
</p>
<ol>
  <ol start="0">
    <li><a href="#1.0">Create test tables</a><br>
    </li>
    <li><a href="#1.1">Study query cache related system variables</a></li>
    <li><a href="#1.2">Perform queries and observe how they are cached</a></li>
    <li><a href="#1.3">Flush the cache</a></li>
    <li><a href="#1.4">Perform selective caching</a></li>
    <li><a href="#1.5">Turn of query caching</a><br>
    </li>
  </ol>
</ol>
<p class="pBody" style="margin-left: 40px;"></p>
<br>
<h3 style="margin-left: 40px;" class="tutorial"><a name="1.0"></a>(1.0)&nbsp;
Create test tables</h3>
<br>
<div style="margin-left: 40px;">
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">USE mydb;<br>
      <br>
/* Drop tables if they exist */<br>
DROP TABLE IF EXISTS employees;&nbsp; <br>
DROP TABLE IF EXISTS departments;<br>
      <br>
/* Create "departments" table */<br>
CREATE TABLE departments ( <br>
&nbsp;&nbsp;&nbsp; department_id int(11) NOT NULL AUTO_INCREMENT, <br>
&nbsp;&nbsp;&nbsp; dname varchar(255) NOT NULL,&nbsp; <br>
&nbsp;&nbsp;&nbsp; PRIMARY KEY&nbsp; (department_id)<br>
) ENGINE=InnoDB;<br>
&nbsp;<br>
&nbsp;<br>
/* Create "employees" table with FOREIGN KEY */<br>
CREATE TABLE employees (&nbsp; <br>
&nbsp;&nbsp;&nbsp; employee_id int(11) NOT NULL AUTO_INCREMENT, <br>
&nbsp;&nbsp;&nbsp; ename varchar(255) NOT NULL, <br>
&nbsp;&nbsp;&nbsp; d_id int(11) NOT NULL,<br>
&nbsp;&nbsp;&nbsp; salary decimal(7,2) NOT NULL,&nbsp; <br>
&nbsp;&nbsp;&nbsp; PRIMARY KEY&nbsp; (employee_id),<br>
&nbsp;&nbsp;&nbsp; FOREIGN KEY (d_id) REFERENCES departments
(department_id)<br>
&nbsp;&nbsp;&nbsp; ON DELETE CASCADE<br>
&nbsp;&nbsp;&nbsp; ON UPDATE CASCADE<br>
) ENGINE=InnoDB;&nbsp;&nbsp;&nbsp; <br>
      <br>
      <br>
/* Data for the table departments */<br>
INSERT INTO departments(department_id, dname)<br>
VALUES<br>
(1,'Engineering'),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
(2,'Sales'),&nbsp;&nbsp;&nbsp;&nbsp; <br>
(3,'Marketing'),<br>
(4,'HR');<br>
      <br>
/* Data for the table employees */<br>
INSERT INTO employees(employee_id, ename, salary, d_id)<br>
VALUES<br>
(1,'jack','3000.00', 1),<br>
(2,'mary','2500.00', 2),<br>
(3,'nichole','4000.00', 1),<br>
(4,'angie','5000.00', 2),<br>
(5,'jones','5000.00', 3);<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">mysql&gt; <span
 style="font-weight: bold;">SOURCE
/handson_mysql/mysql_performance/sqlscripts/joined_tables_without_index.sql;</span><br>
tabase changed<br>
ery OK, 0 rows affected (0.06 sec)<br>
      <br>
ery OK, 0 rows affected (0.06 sec)<br>
      <br>
ery OK, 0 rows affected (0.08 sec)<br>
      <br>
ery OK, 0 rows affected (0.11 sec)<br>
      <br>
ery OK, 4 rows affected (0.04 sec)<br>
cords: 4&nbsp; Duplicates: 0&nbsp; Warnings: 0<br>
      <br>
ery OK, 5 rows affected (0.04 sec)<br>
cords: 5&nbsp; Duplicates: 0&nbsp; Warnings: 0<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <a
 href="index.html#Exercise_1">return to top of exercise</a><br>
</div>
<br>
<h3 style="margin-left: 40px;" class="tutorial"><a name="1.1"></a>(1.1)&nbsp;
Study query cache related system variables,
</h3>
<br>
<div style="margin-left: 40px;"><br>
1. Display query cache related system
variables,<br>
<br>
</div>
<div style="margin-left: 40px;">
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">mysql&gt;&nbsp; <span
 style="font-weight: bold;">SHOW variables LIKE '%query_cache%';</span><br>
+------------------------------+---------+<br>
|
Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| Value&nbsp;&nbsp; |<br>
+------------------------------+---------+<br>
|
have_query_cache&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| YES&nbsp;&nbsp;&nbsp;&nbsp; |<br>
|
query_cache_limit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 1048576 |<br>
| query_cache_min_res_unit&nbsp;&nbsp;&nbsp;&nbsp; |
4096&nbsp;&nbsp;&nbsp; |<br>
|
query_cache_size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
|
query_cache_type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| ON&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| query_cache_wlock_invalidate | OFF&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+------------------------------+---------+<br>
6 rows in set (0.00 sec)<br>
      <br>
mysql&gt;&nbsp; <span style="font-weight: bold;">SHOW STATUS LIKE
'Qcache%';</span><br>
+-------------------------+-------+<br>
|
Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| Value |<br>
+-------------------------+-------+<br>
| Qcache_free_blocks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_free_memory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
|
Qcache_hits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_inserts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_lowmem_prunes&nbsp;&nbsp;&nbsp; | 0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_not_cached&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_queries_in_cache | 0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_total_blocks&nbsp;&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+-------------------------+-------+<br>
8 rows in set (0.00 sec)<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <a
 href="#Exercise_1">return to top of exercise</a><br>
<br>
</div>
<h3 style="margin-left: 40px;" class="tutorial"><a name="1.2"></a>(1.2)&nbsp;
Perform queries and observe how they are cached<br>
</h3>
<div style="margin-left: 40px;"><br>
<img alt="" src="index_files/0stop.jpg"
 style="width: 11px; height: 12px;"> <span style="color: rgb(0, 0, 0);">&lt;Study
points: Query cache related variables&gt;<br>
</span>
<ul>
  <li><span style="color: rgb(0, 0, 0);">query_cache_size: </span>The
amount of memory allocated for caching query results. The default value
is 0, which disables the query cache.&nbsp; For more information, see <a
 href="http://dev.mysql.com/doc/refman/5.1/en/server-system-variables.html#sysvar_query_cache_size">query_cache_size</a>
document.<br>
  </li>
</ul>
<br>
1. Perform queries and observe how they are cached.<br>
<br>
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">mysql&gt;&nbsp; <span
 style="font-weight: bold;">SHOW variables LIKE '%query_cache%';</span><br>
+--------------------------------------+-------------+<br>
|
Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;
| Value &nbsp; &nbsp;&nbsp; &nbsp; |<br>
+--------------------------------------+-------------+<br>
|
have_query_cache&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
| YES&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |<br>
|
query_cache_limit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
| 1048576&nbsp; |<br>
| query_cache_min_res_unit &nbsp; &nbsp;&nbsp; |
4096 &nbsp; &nbsp; &nbsp;&nbsp; |<br>
|
query_cache_size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;
&nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&nbsp;
| 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br>
|
query_cache_type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;
| ON&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; |<br>
| query_cache_wlock_invalidate | OFF&nbsp; &nbsp; &nbsp;&nbsp; &nbsp; |<br>
+--------------------------------------+-------------+<br>
6 rows in set (0.00 sec)<br>
      <br>
mysql&gt; <span style="font-weight: bold;">select * from employees
where employee_id =
5;</span><br>
+-------------+-------+------+---------+<br>
| employee_id | ename | d_id | salary&nbsp; |<br>
+-------------+-------+------+---------+<br>
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5 | jones
|&nbsp;&nbsp;&nbsp; 3 | 5000.00 |<br>
+-------------+-------+------+---------+<br>
1 row in set (0.00 sec)<br>
      <br>
// The reason the previous query has not been cached is because<br>
// <span style="color: rgb(0, 0, 0);">"query_cache_size" variable is
currently set to 0.</span><br>
mysql&gt; <span style="font-weight: bold;">SHOW STATUS LIKE 'Qcache%';</span><br>
+------------------------------------+-------+<br>
|
Variable_name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| Value |<br>
+------------------------------------+-------+<br>
| Qcache_free_blocks&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_free_memory&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
|
Qcache_hits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
| 0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_inserts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;
| 0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_lowmem_prunes&nbsp; &nbsp; &nbsp; | 0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_not_cached&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_queries_in_cache &nbsp;&nbsp; | 0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_total_blocks&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+-------------------------------------+-------+<br>
8 rows in set (0.00 sec)<br>
      <br>
mysql&gt; <span style="font-weight: bold;">SET GLOBAL query_cache_size
= 1048576;</span><br>
Query OK, 0 rows affected (0.00 sec)<br>
      <br>
mysql&gt;<span style="font-weight: bold;">SHOW VARIABLES LIKE
'%query_cache%';</span><br>
+------------------------------+---------+<br>
|
Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| Value&nbsp;&nbsp; |<br>
+------------------------------+---------+<br>
|
have_query_cache&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| YES&nbsp;&nbsp;&nbsp;&nbsp; |<br>
|
query_cache_limit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 1048576 |<br>
| query_cache_min_res_unit&nbsp;&nbsp;&nbsp;&nbsp; |
4096&nbsp;&nbsp;&nbsp; |<br>
|<span style="color: rgb(255, 0, 0);">
query_cache_size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 1048576 |</span><br>
|
query_cache_type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| ON&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| query_cache_wlock_invalidate | OFF&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+------------------------------+---------+<br>
6 rows in set (0.00 sec)<br>
      <br>
mysql&gt; <span style="font-weight: bold;">select * from employees
where employee_id = 5;</span><br>
+----------------+----------+------+-----------+<br>
| employee_id | ename | d_id | salary &nbsp;&nbsp; |<br>
+----------------+----------+------+-----------+<br>
|&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp; 5 | jones &nbsp;
| &nbsp;&nbsp; &nbsp; 3 | 5000.00 |<br>
+----------------+----------+------+-----------+<br>
1 row in set (0.00 sec)<br>
      <br>
// Observe that the previous query has been cached.<br>
mysql&gt;&nbsp; <span style="font-weight: bold;">SHOW STATUS LIKE
'Qcache%';</span><br>
+----------------------------+---------+<br>
|
Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| Value&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
| Qcache_free_blocks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_free_memory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 1038376 |<br>
|
Qcache_hits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
|<span style="color: rgb(255, 0, 0);">
Qcache_inserts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| Qcache_lowmem_prunes&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_not_cached&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| <span style="color: rgb(255, 0, 0);">Qcache_queries_in_cache |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| Qcache_total_blocks&nbsp;&nbsp;&nbsp;&nbsp; |
4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
8 rows in set (0.00 sec)<br>
      <br>
// Now execute the same query.<br>
mysql&gt; <span style="font-weight: bold;">select * from employees
where employee_id = 5;</span><br>
+-------------+-------+------+---------+<br>
| employee_id | ename | d_id | salary&nbsp; |<br>
+-------------+-------+------+---------+<br>
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5 | jones
|&nbsp;&nbsp;&nbsp; 3 | 5000.00 |<br>
+-------------+-------+------+---------+<br>
1 row in set (0.00 sec)<br>
      <br>
// Observe that the query result is from the cache.<br>
// The "Qcache_hits" indicates number of hits to the query cache.<br>
mysql&gt;&nbsp; <span style="font-weight: bold;">SHOW STATUS LIKE
'Qcache%';</span><br>
+-------------------------+---------+<br>
|
Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| Value&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
| Qcache_free_blocks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_free_memory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 1038376 |<br>
| <span style="color: rgb(255, 0, 0);">Qcache_hits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| Qcache_inserts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_lowmem_prunes&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_not_cached&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_queries_in_cache | 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_total_blocks&nbsp;&nbsp;&nbsp;&nbsp; |
4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
8 rows in set (0.00 sec)<br>
      <br>
// Execute a different query.<br>
mysql&gt; <span style="font-weight: bold;">select * from employees
where employee_id = 2;</span><br>
+-------------+-------+------+---------+<br>
| employee_id | ename | d_id | salary&nbsp; |<br>
+-------------+-------+------+---------+<br>
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2 |
mary&nbsp; |&nbsp;&nbsp;&nbsp; 2 | 2500.00 |<br>
+-------------+-------+------+---------+<br>
1 row in set (0.00 sec)<br>
      <br>
// Observe that the previous query is now cached.<br>
mysql&gt; <span style="font-weight: bold;">SHOW STATUS LIKE 'Qcache%';</span><br>
+-------------------------+---------+<br>
|
Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| Value&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
| Qcache_free_blocks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_free_memory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 1037352 |<br>
|
Qcache_hits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| <span style="color: rgb(255, 0, 0);">Qcache_inserts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| Qcache_lowmem_prunes&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_not_cached&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| <span style="color: rgb(255, 0, 0);">Qcache_queries_in_cache |
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| Qcache_total_blocks&nbsp;&nbsp;&nbsp;&nbsp; |
6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
8 rows in set (0.00 sec)<br>
      <br>
// Now do the same query but use upper case SELECT instead of<br>
// lower case select.&nbsp; They are considered different query by the<br>
// query cache.<br>
mysql&gt; <span style="font-weight: bold;">SELECT * from employees
where employee_id = 2;</span><br>
+-------------+-------+------+---------+<br>
| employee_id | ename | d_id | salary&nbsp; |<br>
+-------------+-------+------+---------+<br>
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2 |
mary&nbsp; |&nbsp;&nbsp;&nbsp; 2 | 2500.00 |<br>
+-------------+-------+------+---------+<br>
1 row in set (0.00 sec)<br>
      <br>
// Observe that the previous query is also cached.<br>
mysql&gt; <span style="font-weight: bold;">SHOW STATUS LIKE 'Qcache%';</span><br>
+-------------------------+---------+<br>
|
Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| Value&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
| Qcache_free_blocks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_free_memory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 1036328 |<br>
|
Qcache_hits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| <span style="color: rgb(255, 0, 0);">Qcache_inserts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| Qcache_lowmem_prunes&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_not_cached&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| <span style="color: rgb(255, 0, 0);">Qcache_queries_in_cache |
3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| Qcache_total_blocks&nbsp;&nbsp;&nbsp;&nbsp; |
8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
8 rows in set (0.01 sec)<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <a
 href="index.html#Exercise_1">return to top of exercise</a><br>
<br>
</div>
<h3 style="margin-left: 40px;" class="tutorial"><a name="1.3"></a>(1.3)
Flush the cache<br>
</h3>
<div style="margin-left: 40px;"><br>
</div>
<div style="margin-left: 40px;">
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">// Flush the cacehe.<br>
mysql&gt; <span style="font-weight: bold;">RESET QUERY CACHE;</span><br>
Query OK, 0 rows affected (0.00 sec)<br>
      <br>
// Observe that the "<span style="color: rgb(0, 0, 0);">Qcache_queries_in_cache"
is now 0.</span><br>
mysql&gt; <span style="font-weight: bold;">SHOW STATUS LIKE 'Qcache%';</span><br>
+-------------------------+---------+<br>
|
Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| Value&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
| Qcache_free_blocks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_free_memory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 1039912 |<br>
|
Qcache_hits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_inserts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_lowmem_prunes&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_not_cached&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| <span style="color: rgb(255, 0, 0);">Qcache_queries_in_cache |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| Qcache_total_blocks&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
8 rows in set (0.00 sec)<br>
      <br>
// Perform a new query.<br>
mysql&gt; <span style="font-weight: bold;">select * from employees
where employee_id = 2;</span><br>
+-------------+-------+------+---------+<br>
| employee_id | ename | d_id | salary&nbsp; |<br>
+-------------+-------+------+---------+<br>
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2 |
mary&nbsp; |&nbsp;&nbsp;&nbsp; 2 | 2500.00 |<br>
+-------------+-------+------+---------+<br>
1 row in set (0.00 sec)<br>
      <br>
// Observe that the number of cached query "<span
 style="color: rgb(0, 0, 0);">Qcache_queries_in_cache" is now 1.</span><br>
mysql&gt; <span style="font-weight: bold;">SHOW STATUS LIKE 'Qcache%';</span><br>
+-------------------------+---------+<br>
|
Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| Value&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
| Qcache_free_blocks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_free_memory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 1038376 |<br>
|
Qcache_hits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_inserts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_lowmem_prunes&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_not_cached&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
|<span style="color: rgb(255, 0, 0);"> Qcache_queries_in_cache |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| Qcache_total_blocks&nbsp;&nbsp;&nbsp;&nbsp; |
4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
8 rows in set (0.00 sec)<span style="color: rgb(255, 0, 0);"></span><br>
      </td>
    </tr>
  </tbody>
</table>
<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <a
 href="index.html#Exercise_1">return to top of exercise</a><br>
<br>
</div>
<h3 style="margin-left: 40px;" class="tutorial"><a name="1.4"></a>(1.4)
Perform selective caching<br>
</h3>
<div style="margin-left: 40px;"><br>
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">mysql&gt; <span
 style="font-weight: bold;">SHOW STATUS LIKE 'Qcache%';</span><br>
+-------------------------+---------+<br>
|
Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| Value&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
| Qcache_free_blocks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_free_memory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 1038376 |<br>
|
Qcache_hits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| <span style="color: rgb(255, 0, 0);">Qcache_inserts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| Qcache_lowmem_prunes&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_not_cached&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
|<span style="color: rgb(255, 0, 0);"> Qcache_queries_in_cache |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| Qcache_total_blocks&nbsp;&nbsp;&nbsp;&nbsp; |
4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
8 rows in set (0.00 sec)<br>
      <br>
// Using <span style="color: rgb(0, 0, 0);">SQL_NO_CACHE means "don't
cache this query".</span><br>
mysql&gt; <span style="font-weight: bold;">select <span
 style="color: rgb(255, 0, 0);">SQL_NO_CACHE</span> * from employees
where employee_id = 1;</span><br>
+-------------+-------+------+---------+<br>
| employee_id | ename | d_id | salary&nbsp; |<br>
+-------------+-------+------+---------+<br>
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 |
jack&nbsp; |&nbsp;&nbsp;&nbsp; 1 | 3000.00 |<br>
+-------------+-------+------+---------+<br>
1 row in set (0.00 sec)<br>
      <br>
// Observe that the number of cached query "<span
 style="color: rgb(0, 0, 0);">Qcache_queries_in_cache" <br>
// remains the same.</span><br>
mysql&gt; <span style="font-weight: bold;">SHOW STATUS LIKE 'Qcache%';</span><br>
+-------------------------+---------+<br>
|
Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| Value&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
| Qcache_free_blocks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_free_memory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 1038376 |<br>
|
Qcache_hits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| <span style="color: rgb(255, 0, 0);">Qcache_inserts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| Qcache_lowmem_prunes&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_not_cached&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
|<span style="color: rgb(255, 0, 0);"> Qcache_queries_in_cache |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| Qcache_total_blocks&nbsp;&nbsp;&nbsp;&nbsp; |
4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
8 rows in set (0.00 sec)<br>
      <br>
// You can explicitly say "cache this query" via SQL_CACHE.&nbsp; So
this<br>
// query will be cached.<br>
mysql&gt; <span style="font-weight: bold;">select <span
 style="color: rgb(255, 0, 0);">SQL_CACHE</span> * from employees where
employee_id = 1;</span><br>
+-------------+-------+------+---------+<br>
| employee_id | ename | d_id | salary&nbsp; |<br>
+-------------+-------+------+---------+<br>
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 |
jack&nbsp; |&nbsp;&nbsp;&nbsp; 1 | 3000.00 |<br>
+-------------+-------+------+---------+<br>
1 row in set (0.00 sec)<br>
      <br>
// Observe that the number of cached query "<span
 style="color: rgb(0, 0, 0);">Qcache_queries_in_cache" <br>
// increased by 1 to 2.<br>
      </span>mysql&gt; <span style="font-weight: bold;">SHOW STATUS
LIKE 'Qcache%';</span><br>
+-------------------------+---------+<br>
|
Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| Value&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
| Qcache_free_blocks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_free_memory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 1037352 |<br>
|
Qcache_hits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
|<span style="color: rgb(255, 0, 0);">
Qcache_inserts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| Qcache_lowmem_prunes&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_not_cached&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| <span style="color: rgb(255, 0, 0);">Qcache_queries_in_cache |
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| Qcache_total_blocks&nbsp;&nbsp;&nbsp;&nbsp; |
6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
8 rows in set (0.00 sec)<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <a
 href="index.html#Exercise_1">return to top of exercise</a><br>
<br>
</div>
<h3 style="margin-left: 40px;" class="tutorial"><a name="1.5"></a>(1.5)
Turn off query caching</h3>
<br>
<div style="margin-left: 40px;">
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">mysql&gt; <span
 style="font-weight: bold;">SET SESSION query_cache_type=off;</span><br>
Query OK, 0 rows affected (0.00 sec)<br>
      <br>
mysql&gt; <span style="font-weight: bold;">SHOW VARIABLES LIKE
'%query_cache%';</span><br>
+------------------------------+---------+<br>
|
Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| Value&nbsp;&nbsp; |<br>
+------------------------------+---------+<br>
|
have_query_cache&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| YES&nbsp;&nbsp;&nbsp;&nbsp; |<br>
|
query_cache_limit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 1048576 |<br>
| query_cache_min_res_unit&nbsp;&nbsp;&nbsp;&nbsp; |
4096&nbsp;&nbsp;&nbsp; |<br>
|
query_cache_size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 1048576 |<br>
|<span style="color: rgb(255, 0, 0);">
query_cache_type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| OFF&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| query_cache_wlock_invalidate | OFF&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+------------------------------+---------+<br>
6 rows in set (0.00 sec)<br>
      <br>
mysql&gt; <span style="font-weight: bold;">RESET QUERY CACHE;</span><br>
Query OK, 0 rows affected (0.00 sec)<br>
      <br>
mysql&gt; <span style="font-weight: bold;">SHOW STATUS LIKE 'Qcache%';</span><br>
+-------------------------+---------+<br>
|
Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| Value&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
| Qcache_free_blocks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_free_memory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 1039912 |<br>
|
Qcache_hits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_inserts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_lowmem_prunes&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_not_cached&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| <span style="color: rgb(255, 0, 0);">Qcache_queries_in_cache |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| Qcache_total_blocks&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
8 rows in set (0.01 sec)<br>
      <br>
mysql&gt; select * from employees where employee_id = 1;<br>
+-------------+-------+------+---------+<br>
| employee_id | ename | d_id | salary&nbsp; |<br>
+-------------+-------+------+---------+<br>
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 |
jack&nbsp; |&nbsp;&nbsp;&nbsp; 1 | 3000.00 |<br>
+-------------+-------+------+---------+<br>
1 row in set (0.00 sec)<br>
      <br>
mysql&gt; SHOW STATUS LIKE 'Qcache%';<br>
+-------------------------+---------+<br>
|
Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| Value&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
| Qcache_free_blocks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_free_memory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 1039912 |<br>
|
Qcache_hits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_inserts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_lowmem_prunes&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_not_cached&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_queries_in_cache | 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_total_blocks&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
8 rows in set (0.00 sec)<br>
      <br>
mysql&gt; select SQL_CACHE * from employees where employee_id = 1;<br>
+-------------+-------+------+---------+<br>
| employee_id | ename | d_id | salary&nbsp; |<br>
+-------------+-------+------+---------+<br>
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 |
jack&nbsp; |&nbsp;&nbsp;&nbsp; 1 | 3000.00 |<br>
+-------------+-------+------+---------+<br>
1 row in set (0.00 sec)<br>
      <br>
mysql&gt; SHOW STATUS LIKE 'Qcache%';<br>
+-------------------------+---------+<br>
|
Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| Value&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
| Qcache_free_blocks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_free_memory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 1039912 |<br>
|
Qcache_hits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_inserts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_lowmem_prunes&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_not_cached&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_queries_in_cache | 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Qcache_total_blocks&nbsp;&nbsp;&nbsp;&nbsp; |
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+-------------------------+---------+<br>
8 rows in set (0.00 sec)<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <a
 href="index.html#Exercise_1">return to top of exercise</a><br>
</div>
<br>
<div style="margin-left: 40px;"><br>
</div>
<br>
<br>
<h2><a name="Exercise_2"></a>Exercise 2: Query optimization - Using
Indexing<br>
</h2>
<p class="pBody" style="margin-left: 40px;">Indexing is the most
important tool you have for speeding up queries. Other
techniques are available to you, too, but generally the one thing that
makes the
most difference is the proper use of indexes.<br>
</p>
<ul>
  <ul>
    <li>Handler_read_first: Number of times the first entry was read
from an index. If this is high, it suggests that the server is doing a
lot of full index scans.</li>
    <li>Handler_read_key: Number of requests to read a row based on a
key. If this is high, it is a good indication that your queries and
tables are properly indexed.</li>
    <li>Handler_read_rnd:-Number of requests to read a row based on a
fixed position. This will be high if you are doing a lot of queries
that require sorting of the result.&nbsp; <br>
    </li>
  </ul>
</ul>
<ol>
  <ol>
    <li><a href="#2.1">Query without index'ing</a></li>
    <li><a href="#2.2">Query with index'ing</a><br>
    </li>
  </ol>
</ol>
<p class="pBody" style="margin-left: 40px;"></p>
<br>
<h3 style="margin-left: 40px;" class="tutorial"><a name="2.1"></a>(2.1)&nbsp;
Query without Index'ing<br>
</h3>
<br>
<div style="margin-left: 40px;">0. Study <span
 style="font-weight: bold;">joined_tables_without_index.sql</span><br>
<br>
</div>
<div style="margin-left: 40px;">
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">USE mydb;<br>
      <br>
/* Drop tables if they exist */<br>
DROP TABLE IF EXISTS employees;&nbsp; <br>
DROP TABLE IF EXISTS departments;<br>
      <br>
/* Create "departments" table */<br>
CREATE TABLE departments ( <br>
&nbsp;&nbsp;&nbsp; department_id int(11) NOT NULL AUTO_INCREMENT, <br>
&nbsp;&nbsp;&nbsp; dname varchar(255) NOT NULL,&nbsp; <br>
&nbsp;&nbsp;&nbsp; PRIMARY KEY&nbsp; (department_id)<br>
) ENGINE=InnoDB;<br>
&nbsp;<br>
&nbsp;<br>
/* Create "employees" table with FOREIGN KEY */<br>
CREATE TABLE employees (&nbsp; <br>
&nbsp;&nbsp;&nbsp; employee_id int(11) NOT NULL AUTO_INCREMENT, <br>
&nbsp;&nbsp;&nbsp; ename varchar(255) NOT NULL, <br>
&nbsp;&nbsp;&nbsp; d_id int(11) NOT NULL,<br>
&nbsp;&nbsp;&nbsp; salary decimal(7,2) NOT NULL, <br>
&nbsp;&nbsp;&nbsp; PRIMARY KEY&nbsp; (employee_id),<br>
&nbsp;&nbsp;&nbsp; FOREIGN KEY (d_id) REFERENCES departments
(department_id)<br>
&nbsp;&nbsp;&nbsp; ON DELETE CASCADE<br>
&nbsp;&nbsp;&nbsp; ON UPDATE CASCADE<br>
) ENGINE=InnoDB;&nbsp;&nbsp;&nbsp; <br>
      <br>
      <br>
/* Data for the table departments */<br>
INSERT INTO departments(department_id, dname)<br>
VALUES<br>
(1,'Engineering'),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
(2,'Sales'),&nbsp;&nbsp;&nbsp;&nbsp; <br>
(3,'Marketing'),<br>
(4,'HR');<br>
      <br>
/* Data for the table employees */<br>
INSERT INTO employees(employee_id, ename, salary, d_id)<br>
VALUES<br>
(1,'jack','3000.00', 1),<br>
(2,'mary','2500.00', 2),<br>
(3,'nichole','4000.00', 1),<br>
(4,'angie','5000.00', 2),<br>
(5,'jones','5000.00', 3);<br>
      <br>
      <br>
/* Observe the impact of having INDEX */<br>
SHOW STATUS LIKE '%handler_read%';<br>
      <br>
SELECT 'Inner Join', employees.ename, employees.salary,
departments.dname<br>
FROM employees<br>
JOIN departments<br>
WHERE employees.d_id=departments.department_id AND<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; employees.ename='jack';<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
SHOW STATUS LIKE '%handler_read%';<br>
      <br>
/* Analyze the query using EXPLAIN */<br>
EXPLAIN SELECT 'Inner Join', employees.ename, employees.salary,
departments.dname<br>
FROM employees<br>
JOIN departments<br>
WHERE employees.d_id=departments.department_id AND<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; employees.ename='jack'\G<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
1. Execute <span style="font-weight: bold;">joined_tables_without_index.sql<br>
<br>
</span>
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">mysql&gt; <span
 style="font-weight: bold;">SOURCE
/handson_mysql/mysql_performance/sqlscripts/joined_tables_without_index.sql;</span><br>
Database changed<br>
Query OK, 0 rows affected (0.04 sec)<br>
      <br>
Query OK, 0 rows affected (0.04 sec)<br>
      <br>
Query OK, 0 rows affected (0.09 sec)<br>
      <br>
Query OK, 0 rows affected (0.10 sec)<br>
      <br>
Query OK, 4 rows affected (0.04 sec)<br>
Records: 4&nbsp; Duplicates: 0&nbsp; Warnings: 0<br>
      <br>
Query OK, 5 rows affected (0.04 sec)<br>
Records: 5&nbsp; Duplicates: 0&nbsp; Warnings: 0<br>
      <br>
+-----------------------+-------+<br>
| Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | Value
|<br>
+-----------------------+-------+<br>
| Handler_read_first&nbsp;&nbsp;&nbsp; | 0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| <span style="color: rgb(255, 0, 0);">Handler_read_key&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 2&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| Handler_read_next&nbsp;&nbsp;&nbsp;&nbsp; | 0&nbsp;&nbsp;&nbsp;&nbsp;
|<br>
| Handler_read_prev&nbsp;&nbsp;&nbsp;&nbsp; | 0&nbsp;&nbsp;&nbsp;&nbsp;
|<br>
| Handler_read_rnd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
|<span style="color: rgb(255, 0, 0);"> Handler_read_rnd_next |
0&nbsp;&nbsp;&nbsp;&nbsp; </span>|<br>
+-----------------------+-------+<br>
6 rows in set (0.00 sec)<br>
      <br>
+------------+-------+---------+-------------+<br>
| Inner Join | ename | salary&nbsp; |
dname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+------------+-------+---------+-------------+<br>
| Inner Join | jack&nbsp; | 3000.00 | Engineering |<br>
+------------+-------+---------+-------------+<br>
1 row in set (0.00 sec)<br>
      <br>
+-----------------------+-------+<br>
| Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | Value
|<br>
+-----------------------+-------+<br>
| Handler_read_first&nbsp;&nbsp;&nbsp; | 2&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| <span style="color: rgb(255, 0, 0);">Handler_read_key&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| 6&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| Handler_read_next&nbsp;&nbsp;&nbsp;&nbsp; | 0&nbsp;&nbsp;&nbsp;&nbsp;
|<br>
| Handler_read_prev&nbsp;&nbsp;&nbsp;&nbsp; | 0&nbsp;&nbsp;&nbsp;&nbsp;
|<br>
| Handler_read_rnd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
|<span style="color: rgb(255, 0, 0);"> Handler_read_rnd_next |
11&nbsp;&nbsp;&nbsp; |</span><br>
+-----------------------+-------+<br>
6 rows in set (0.00 sec)<br>
      <br>
mysql&gt;<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <a
 href="index.html#Exercise_2">return to top of exercise</a><br>
<br>
</div>
<h3 style="margin-left: 40px;" class="tutorial"><a name="2.2"></a>(2.2)&nbsp;
Query with Index'ing</h3>
<div style="margin-left: 40px;"><br>
0. Study <span style="font-weight: bold;">joined_tables_with_index.sql</span><br>
<br>
</div>
<div style="margin-left: 40px;">
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">USE mydb;<br>
      <br>
/* Drop tables if they exist */<br>
DROP TABLE IF EXISTS employees;&nbsp; <br>
DROP TABLE IF EXISTS departments;<br>
      <br>
/* Create "departments" table */<br>
CREATE TABLE departments ( <br>
&nbsp;&nbsp;&nbsp; department_id int(11) NOT NULL AUTO_INCREMENT, <br>
&nbsp;&nbsp;&nbsp; dname varchar(255) NOT NULL,&nbsp; <br>
&nbsp;&nbsp;&nbsp; PRIMARY KEY&nbsp; (department_id)<br>
) ENGINE=InnoDB;<br>
&nbsp;<br>
&nbsp;<br>
/* Create "employees" table with FOREIGN KEY */<br>
CREATE TABLE employees (&nbsp; <br>
&nbsp;&nbsp;&nbsp; employee_id int(11) NOT NULL AUTO_INCREMENT, <br>
&nbsp;&nbsp;&nbsp; ename varchar(255) NOT NULL, <br>
&nbsp;&nbsp;&nbsp; d_id int(11) NOT NULL,<br>
&nbsp;&nbsp;&nbsp; salary decimal(7,2) NOT NULL, <br>
&nbsp;&nbsp;&nbsp;<span style="font-weight: bold;"> /* INDEX on ename */</span><br
 style="font-weight: bold;">
      <span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; INDEX (ename),</span><br>
&nbsp;&nbsp;&nbsp; PRIMARY KEY&nbsp; (employee_id),<br>
&nbsp;&nbsp;&nbsp; FOREIGN KEY (d_id) REFERENCES departments
(department_id)<br>
&nbsp;&nbsp;&nbsp; ON DELETE CASCADE<br>
&nbsp;&nbsp;&nbsp; ON UPDATE CASCADE<br>
) ENGINE=InnoDB;&nbsp;&nbsp;&nbsp; <br>
      <br>
      <br>
/* Data for the table departments */<br>
INSERT INTO departments(department_id, dname)<br>
VALUES<br>
(1,'Engineering'),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
(2,'Sales'),&nbsp;&nbsp;&nbsp;&nbsp; <br>
(3,'Marketing'),<br>
(4,'HR');<br>
      <br>
/* Data for the table employees */<br>
INSERT INTO employees(employee_id, ename, salary, d_id)<br>
VALUES<br>
(1,'jack','3000.00', 1),<br>
(2,'mary','2500.00', 2),<br>
(3,'nichole','4000.00', 1),<br>
(4,'angie','5000.00', 2),<br>
(5,'jones','5000.00', 3);<br>
      <br>
      <br>
/* Observe the impact of having INDEX */<br>
SHOW STATUS LIKE '%handler_read%';<br>
      <br>
SELECT 'Inner Join', employees.ename, employees.salary,
departments.dname<br>
FROM employees<br>
JOIN departments<br>
WHERE employees.d_id=departments.department_id AND<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; employees.ename='jack';<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
SHOW STATUS LIKE '%handler_read%';<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
1. Execute <span style="font-weight: bold;">joined_tables_with_index.sql<br>
<br>
</span></div>
<div style="margin-left: 40px;">
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">C:\Users\sang&gt;<span
 style="font-weight: bold;">mysql -u root -p</span><br>
Enter password:<br>
Welcome to the MySQL monitor.&nbsp; Commands end with ; or \g.<br>
Your MySQL connection id is 7<br>
Server version: 5.1.44-community MySQL Community Server (GPL)<br>
      <br>
Type 'help;' or '\h' for help. Type '\c' to clear the current input
statement.<br>
      <br>
mysql&gt; <span style="font-weight: bold;">SOURCE
/handson_mysql/mysql_performance/sqlscripts/joined_tables_with_index.sql;</span><br>
Database changed<br>
Query OK, 0 rows affected (0.05 sec)<br>
      <br>
Query OK, 0 rows affected (0.04 sec)<br>
      <br>
Query OK, 0 rows affected (0.15 sec)<br>
      <br>
Query OK, 0 rows affected (0.12 sec)<br>
      <br>
Query OK, 4 rows affected (0.04 sec)<br>
Records: 4&nbsp; Duplicates: 0&nbsp; Warnings: 0<br>
      <br>
Query OK, 5 rows affected (0.03 sec)<br>
Records: 5&nbsp; Duplicates: 0&nbsp; Warnings: 0<br>
      <br>
+-----------------------+-------+<br>
| Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | Value
|<br>
+-----------------------+-------+<br>
| Handler_read_first&nbsp;&nbsp;&nbsp; | 0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Handler_read_key&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
2&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Handler_read_next&nbsp;&nbsp;&nbsp;&nbsp; | 0&nbsp;&nbsp;&nbsp;&nbsp;
|<br>
| Handler_read_prev&nbsp;&nbsp;&nbsp;&nbsp; | 0&nbsp;&nbsp;&nbsp;&nbsp;
|<br>
| Handler_read_rnd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Handler_read_rnd_next | 0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+-----------------------+-------+<br>
6 rows in set (0.00 sec)<br>
      <br>
+------------+-------+---------+-------------+<br>
| Inner Join | ename | salary&nbsp; |
dname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+------------+-------+---------+-------------+<br>
| Inner Join | jack&nbsp; | 3000.00 | Engineering |<br>
+------------+-------+---------+-------------+<br>
1 row in set (0.00 sec)<br>
      <br>
+-----------------------+-------+<br>
| Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | Value
|<br>
+-----------------------+-------+<br>
| Handler_read_first&nbsp;&nbsp;&nbsp; | 0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
|<span style="color: rgb(255, 0, 0);">
Handler_read_key&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
6&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
| Handler_read_next&nbsp;&nbsp;&nbsp;&nbsp; | 1&nbsp;&nbsp;&nbsp;&nbsp;
|<br>
| Handler_read_prev&nbsp;&nbsp;&nbsp;&nbsp; | 0&nbsp;&nbsp;&nbsp;&nbsp;
|<br>
| Handler_read_rnd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
|<span style="color: rgb(255, 0, 0);"> Handler_read_rnd_next |
0&nbsp;&nbsp;&nbsp;&nbsp; |</span><br>
+-----------------------+-------+<br>
6 rows in set (0.00 sec)<br>
      <br>
mysql&gt;<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <a
 href="index.html#Exercise_2">return to top of exercise</a><br>
<br>
</div>
<br>
<h2><a name="Exercise_3"></a>Exercise 3: EXPLAIN</h2>
<div style="margin-left: 40px;"><br>
EXPLAIN is used to obtain information about how MySQL executes a SELECT
statement.&nbsp; When you precede a SELECT&nbsp; statement with the
keyword EXPLAIN, MySQL displays information from the optimizer about
the query execution plan. That is, MySQL explains how it would process
the SELECT, including information about how tables are joined and in
which order. <br>
</div>
<ol>
  <ol>
    <li><a href="#3.1">Use EXPLAIN for query without indexing</a></li>
    <li><a href="#3.2">Use EXPLAIN for query with indexing</a><br>
    </li>
  </ol>
</ol>
<h3 style="margin-left: 40px;" class="tutorial"><a name="3.1"></a>(3.1)&nbsp;
Use EXPLAIN for query without indexing</h3>
<br>
<div style="margin-left: 40px;">1. Study <span
 style="font-weight: bold;">explain_joined_tables_without_index.sql<br>
<br>
</span></div>
<div style="margin-left: 40px;">
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">USE mydb;<br>
      <br>
/* Drop tables if they exist */<br>
DROP TABLE IF EXISTS employees;&nbsp; <br>
DROP TABLE IF EXISTS departments;<br>
      <br>
/* Create "departments" table */<br>
CREATE TABLE departments ( <br>
&nbsp;&nbsp;&nbsp; department_id int(11) NOT NULL AUTO_INCREMENT, <br>
&nbsp;&nbsp;&nbsp; dname varchar(255) NOT NULL,&nbsp; <br>
&nbsp;&nbsp;&nbsp; PRIMARY KEY&nbsp; (department_id)<br>
) ENGINE=InnoDB;<br>
&nbsp;<br>
&nbsp;<br>
/* Create "employees" table with FOREIGN KEY */<br>
CREATE TABLE employees (&nbsp; <br>
&nbsp;&nbsp;&nbsp; employee_id int(11) NOT NULL AUTO_INCREMENT, <br>
&nbsp;&nbsp;&nbsp; ename varchar(255) NOT NULL, <br>
&nbsp;&nbsp;&nbsp; d_id int(11) NOT NULL,<br>
&nbsp;&nbsp;&nbsp; salary decimal(7,2) NOT NULL, <br>
&nbsp;&nbsp;&nbsp; PRIMARY KEY&nbsp; (employee_id),<br>
&nbsp;&nbsp;&nbsp; FOREIGN KEY (d_id) REFERENCES departments
(department_id)<br>
&nbsp;&nbsp;&nbsp; ON DELETE CASCADE<br>
&nbsp;&nbsp;&nbsp; ON UPDATE CASCADE<br>
) ENGINE=InnoDB;&nbsp;&nbsp;&nbsp; <br>
      <br>
      <br>
/* Data for the table departments */<br>
INSERT INTO departments(department_id, dname)<br>
VALUES<br>
(1,'Engineering'),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
(2,'Sales'),&nbsp;&nbsp;&nbsp;&nbsp; <br>
(3,'Marketing'),<br>
(4,'HR');<br>
      <br>
/* Data for the table employees */<br>
INSERT INTO employees(employee_id, ename, salary, d_id)<br>
VALUES<br>
(1,'jack','3000.00', 1),<br>
(2,'mary','2500.00', 2),<br>
(3,'nichole','4000.00', 1),<br>
(4,'angie','5000.00', 2),<br>
(5,'jones','5000.00', 3);<br>
      <br>
      <span style="font-weight: bold; color: rgb(255, 0, 0);">/*
Analyze the query using EXPLAIN */</span><br
 style="font-weight: bold; color: rgb(255, 0, 0);">
      <span style="font-weight: bold; color: rgb(255, 0, 0);">EXPLAIN
SELECT 'Inner Join', employees.ename, employees.salary,
departments.dname</span><br
 style="font-weight: bold; color: rgb(255, 0, 0);">
      <span style="font-weight: bold; color: rgb(255, 0, 0);">FROM
employees</span><br style="font-weight: bold; color: rgb(255, 0, 0);">
      <span style="font-weight: bold; color: rgb(255, 0, 0);">JOIN
departments</span><br style="font-weight: bold; color: rgb(255, 0, 0);">
      <span style="font-weight: bold; color: rgb(255, 0, 0);">WHERE
employees.d_id=departments.department_id AND</span><br
 style="font-weight: bold; color: rgb(255, 0, 0);">
      <span style="font-weight: bold; color: rgb(255, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
employees.ename='jones'\G</span><br>
      </td>
    </tr>
  </tbody>
</table>
<br>
2. Execute <span style="font-weight: bold;">explain_joined_tables_without_index.sql</span><br>
<br>
Note that without indexing, the number of rows MySQL is expected to
read is the total number of rows of each table, 5 for the employees
table and 4 for the departments table.<br>
<br>
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">mysql&gt; <span
 style="font-weight: bold;">SOURCE
/handson_mysql/mysql_performance/sqlscripts/explain_joined_tables_without_index.sql;</span><br>
Database changed<br>
Query OK, 0 rows affected (0.05 sec)<br>
      <br>
Query OK, 0 rows affected (0.05 sec)<br>
      <br>
Query OK, 0 rows affected (0.11 sec)<br>
      <br>
Query OK, 0 rows affected (0.21 sec)<br>
      <br>
Query OK, 4 rows affected (0.04 sec)<br>
Records: 4&nbsp; Duplicates: 0&nbsp; Warnings: 0<br>
      <br>
Query OK, 5 rows affected (0.04 sec)<br>
Records: 5&nbsp; Duplicates: 0&nbsp; Warnings: 0<br>
      <br>
*************************** 1. row ***************************<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; id: 1<br>
&nbsp; select_type: SIMPLE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; table: employees<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; type: ALL<br>
      <span style="color: rgb(255, 0, 0);">possible_keys: d_id</span><br
 style="color: rgb(255, 0, 0);">
      <span style="color: rgb(255, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
key: NULL</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key_len: NULL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ref: NULL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span
 style="color: rgb(255, 0, 0);">rows: 5</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Extra: Using where<br>
*************************** 2. row ***************************<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; id: 1<br>
&nbsp; select_type: SIMPLE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; table: departments<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; type: ALL<br>
      <span style="color: rgb(255, 0, 0);">possible_keys: PRIMARY</span><br
 style="color: rgb(255, 0, 0);">
      <span style="color: rgb(255, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
key: NULL</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key_len: NULL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ref: NULL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span
 style="color: rgb(255, 0, 0);"> rows: 4</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Extra: Using where; Using
join buffer<br>
2 rows in set (0.00 sec)<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <a
 href="index.html#Exercise_3">return to top of exercise</a><br>
</div>
<br>
<h3 style="margin-left: 40px;" class="tutorial"><a name="3.2"></a>(3.2)&nbsp;
Use EXPLAIN for query with indexing<br>
</h3>
<br>
<div style="margin-left: 40px;">1. Study <span
 style="font-weight: bold;">explain_joined_tables_with_index.sql</span><br>
<br>
</div>
<div style="margin-left: 40px;">
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">USE mydb;<br>
      <br>
/* Drop tables if they exist */<br>
DROP TABLE IF EXISTS employees;&nbsp; <br>
DROP TABLE IF EXISTS departments;<br>
      <br>
/* Create "departments" table */<br>
CREATE TABLE departments ( <br>
&nbsp;&nbsp;&nbsp; department_id int(11) NOT NULL AUTO_INCREMENT, <br>
&nbsp;&nbsp;&nbsp; dname varchar(255) NOT NULL,&nbsp; <br>
&nbsp;&nbsp;&nbsp; PRIMARY KEY&nbsp; (department_id)<br>
) ENGINE=InnoDB;<br>
&nbsp;<br>
&nbsp;<br>
/* Create "employees" table with FOREIGN KEY */<br>
CREATE TABLE employees (&nbsp; <br>
&nbsp;&nbsp;&nbsp; employee_id int(11) NOT NULL AUTO_INCREMENT, <br>
&nbsp;&nbsp;&nbsp; ename varchar(255) NOT NULL, <br>
&nbsp;&nbsp;&nbsp; d_id int(11) NOT NULL,<br>
&nbsp;&nbsp;&nbsp; salary decimal(7,2) NOT NULL, <br>
&nbsp;&nbsp;&nbsp; /* INDEX on ename */<br>
&nbsp;&nbsp;&nbsp; INDEX (ename),<br>
&nbsp;&nbsp;&nbsp; PRIMARY KEY&nbsp; (employee_id),<br>
&nbsp;&nbsp;&nbsp; FOREIGN KEY (d_id) REFERENCES departments
(department_id)<br>
&nbsp;&nbsp;&nbsp; ON DELETE CASCADE<br>
&nbsp;&nbsp;&nbsp; ON UPDATE CASCADE<br>
) ENGINE=InnoDB;&nbsp;&nbsp;&nbsp; <br>
      <br>
      <br>
/* Data for the table departments */<br>
INSERT INTO departments(department_id, dname)<br>
VALUES<br>
(1,'Engineering'),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
(2,'Sales'),&nbsp;&nbsp;&nbsp;&nbsp; <br>
(3,'Marketing'),<br>
(4,'HR');<br>
      <br>
/* Data for the table employees */<br>
INSERT INTO employees(employee_id, ename, salary, d_id)<br>
VALUES<br>
(1,'jack','3000.00', 1),<br>
(2,'mary','2500.00', 2),<br>
(3,'nichole','4000.00', 1),<br>
(4,'angie','5000.00', 2),<br>
(5,'jones','5000.00', 3);<br>
      <br>
      <span style="font-weight: bold;">/* Analyze the query using
EXPLAIN */</span><br style="font-weight: bold;">
      <span style="font-weight: bold;"><span
 style="color: rgb(255, 0, 0);">EXPLAIN </span>SELECT 'Inner Join',
employees.ename, employees.salary, departments.dname</span><br
 style="font-weight: bold;">
      <span style="font-weight: bold;">FROM employees</span><br
 style="font-weight: bold;">
      <span style="font-weight: bold;">JOIN departments</span><br
 style="font-weight: bold;">
      <span style="font-weight: bold;">WHERE
employees.d_id=departments.department_id AND</span><br
 style="font-weight: bold;">
      <span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
employees.ename='jack'\G</span><br>
      </td>
    </tr>
  </tbody>
</table>
&nbsp;<br>
2. Execute <span style="font-weight: bold;">explain_joined_tables_with_index.sql<br>
<br>
</span>Note that with indexing, the number of rows MySQL is expected to
read is 1 for both employees and departments tables.<br>
<br>
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">mysql&gt; <span
 style="font-weight: bold;">SOURCE
/handson_mysql/mysql_performance/sqlscripts/explain_joined_tables_with_index.sql;</span><br>
Database changed<br>
Query OK, 0 rows affected (0.17 sec)<br>
      <br>
Query OK, 0 rows affected (0.08 sec)<br>
      <br>
Query OK, 0 rows affected (0.17 sec)<br>
      <br>
Query OK, 0 rows affected (0.12 sec)<br>
      <br>
Query OK, 4 rows affected (0.06 sec)<br>
Records: 4&nbsp; Duplicates: 0&nbsp; Warnings: 0<br>
      <br>
Query OK, 5 rows affected (0.06 sec)<br>
Records: 5&nbsp; Duplicates: 0&nbsp; Warnings: 0<br>
      <br>
*************************** 1. row ***************************<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; id: 1<br>
&nbsp; select_type: SIMPLE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; table: employees<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; type: ref<br>
      <span style="color: rgb(255, 0, 0);">possible_keys: ename,d_id</span><br
 style="color: rgb(255, 0, 0);">
      <span style="color: rgb(255, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
key: ename</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key_len: 257<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ref: const<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span
 style="color: rgb(255, 0, 0);">rows: 1</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Extra: Using where<br>
*************************** 2. row ***************************<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; id: 1<br>
&nbsp; select_type: SIMPLE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; table: departments<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; type: eq_ref<br>
      <span style="color: rgb(255, 0, 0);">possible_keys: PRIMARY</span><br
 style="color: rgb(255, 0, 0);">
      <span style="color: rgb(255, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
key: PRIMARY</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key_len: 4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ref:
mydb.employees.d_id<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span
 style="color: rgb(255, 0, 0);">rows: 1</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Extra:<br>
2 rows in set (0.05 sec)<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
</div>
<div style="margin-left: 40px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <a
 href="index.html#Exercise_3">return to top of exercise</a><br>
</div>
<br>
<h2><a name="Exercise_4"></a>Exercise 4: Slow query log<br>
</h2>
<p class="pBody" style="margin-left: 40px;">MySQL has a feature that
allows you to log slow running queries to a file called Slow query log.
These queries are the candidates for optimization.<br>
</p>
<ol>
  <ol>
    <li><a href="#4.1">Set dlow query log system variable</a></li>
    <li><a href="#4.2">Perform some query operations</a><br>
    </li>
  </ol>
</ol>
<p class="pBody" style="margin-left: 40px;"></p>
<br>
<h3 style="margin-left: 40px;" class="tutorial"><a name="4.1"></a>(4.1)&nbsp;
Set slow query log system variable<br>
</h3>
<br>
<div style="margin-left: 40px;">
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">mysql&gt; <span
 style="font-weight: bold;">SHOW VARIABLES LIKE '%slow%';</span><br>
+---------------------+--------------------------------------------------------------------+<br>
| Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
Value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|<br>
+---------------------+--------------------------------------------------------------------+<br>
| log_slow_queries&nbsp;&nbsp;&nbsp; |
OFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|<br>
| slow_launch_time&nbsp;&nbsp;&nbsp; |
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|<br>
| slow_query_log&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
OFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|<br>
| slow_query_log_file | C:\ProgramData\MySQL\MySQL Server
5.1\Data\SangShinLaptop-slow.log |<br>
+---------------------+--------------------------------------------------------------------+<br>
4 rows in set (0.00 sec)<br>
      <br>
mysql&gt; <span style="font-weight: bold;">SHOW VARIABLES LIKE
'%long_query%';</span><br>
+-----------------+-----------+<br>
| Variable_name&nbsp;&nbsp; | Value&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+-----------------+-----------+<br>
| long_query_time | 10.000000 |<br>
+-----------------+-----------+<br>
1 row in set (0.00 sec)<br>
      <br>
mysql&gt; <span style="font-weight: bold;">SET GLOBAL
slow_query_log=ON;</span><br>
Query OK, 0 rows affected (0.13 sec)<br>
      <br>
mysql&gt; <span style="font-weight: bold;">SHOW VARIABLES LIKE
'%slow%';</span><br>
+---------------------+------------------------------------------------------<br>
| Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | Value<br>
+---------------------+------------------------------------------------------<br>
| <span style="color: rgb(255, 0, 0);">log_slow_queries&nbsp;&nbsp;&nbsp;
| ON</span><br>
| slow_launch_time&nbsp;&nbsp;&nbsp; | 2<br>
| <span style="color: rgb(255, 0, 0);">slow_query_log&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
| ON</span><br>
| slow_query_log_file | C:\ProgramData\MySQL\MySQL Server
5.1\Data\SangShinLaptop-slow.log |<br>
+---------------------+------------------------------------------------------<br>
4 rows in set (0.03 sec)<br>
      <br>
mysql&gt; <span style="font-weight: bold;">SET long_query_time=0.0001;</span><br>
Query OK, 0 rows affected (0.00 sec)<br>
      <br>
mysql&gt; <span style="font-weight: bold;">SHOW VARIABLES LIKE
'%long_query%';</span><br>
+-----------------+----------+<br>
| Variable_name&nbsp;&nbsp; | Value&nbsp;&nbsp;&nbsp; |<br>
+-----------------+----------+<br>
| long_query_time | 0.000100 |<br>
+-----------------+----------+<br>
1 row in set (0.00 sec)<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <a
 href="index.html#Exercise_4">return to top of exercise</a><br>
<br>
</div>
<h3 style="margin-left: 40px;" class="tutorial"><a name="4.2"></a>(4.2)
Perform some query operations<br>
</h3>
<div style="margin-left: 40px;"><br>
</div>
<div style="margin-left: 40px;">
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">mysql&gt; <span
 style="font-weight: bold;">SOURCE
/handson_mysql/mysql_performance/sqlscripts/joined_tables_with_index.sql;</span><br>
Database changed<br>
Query OK, 0 rows affected (0.04 sec)<br>
      <br>
Query OK, 0 rows affected (0.03 sec)<br>
      <br>
Query OK, 0 rows affected (0.10 sec)<br>
      <br>
Query OK, 0 rows affected (0.09 sec)<br>
      <br>
Query OK, 4 rows affected (0.04 sec)<br>
Records: 4&nbsp; Duplicates: 0&nbsp; Warnings: 0<br>
      <br>
Query OK, 5 rows affected (0.03 sec)<br>
Records: 5&nbsp; Duplicates: 0&nbsp; Warnings: 0<br>
      <br>
+-----------------------+-------+<br>
| Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | Value
|<br>
+-----------------------+-------+<br>
| Handler_read_first&nbsp;&nbsp;&nbsp; | 0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Handler_read_key&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
9&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Handler_read_next&nbsp;&nbsp;&nbsp;&nbsp; | 4&nbsp;&nbsp;&nbsp;&nbsp;
|<br>
| Handler_read_prev&nbsp;&nbsp;&nbsp;&nbsp; | 0&nbsp;&nbsp;&nbsp;&nbsp;
|<br>
| Handler_read_rnd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Handler_read_rnd_next | 31&nbsp;&nbsp;&nbsp; |<br>
+-----------------------+-------+<br>
6 rows in set (0.00 sec)<br>
      <br>
+------------+-------+---------+-------------+<br>
| Inner Join | ename | salary&nbsp; |
dname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>
+------------+-------+---------+-------------+<br>
| Inner Join | jack&nbsp; | 3000.00 | Engineering |<br>
+------------+-------+---------+-------------+<br>
1 row in set (0.00 sec)<br>
      <br>
+-----------------------+-------+<br>
| Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | Value
|<br>
+-----------------------+-------+<br>
| Handler_read_first&nbsp;&nbsp;&nbsp; | 0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Handler_read_key&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 13&nbsp;&nbsp;&nbsp;
|<br>
| Handler_read_next&nbsp;&nbsp;&nbsp;&nbsp; | 5&nbsp;&nbsp;&nbsp;&nbsp;
|<br>
| Handler_read_prev&nbsp;&nbsp;&nbsp;&nbsp; | 0&nbsp;&nbsp;&nbsp;&nbsp;
|<br>
| Handler_read_rnd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
0&nbsp;&nbsp;&nbsp;&nbsp; |<br>
| Handler_read_rnd_next | 31&nbsp;&nbsp;&nbsp; |<br>
+-----------------------+-------+<br>
6 rows in set (0.00 sec)<br>
      <br>
*************************** 1. row ***************************<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; id: 1<br>
&nbsp; select_type: SIMPLE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; table: employees<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; type: ref<br>
possible_keys: ename,d_id<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key: ename<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key_len: 257<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ref: const<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rows: 1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Extra: Using where<br>
*************************** 2. row ***************************<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; id: 1<br>
&nbsp; select_type: SIMPLE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; table: departments<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; type: eq_ref<br>
possible_keys: PRIMARY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key: PRIMARY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key_len: 4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ref:
mydb.employees.d_id<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rows: 1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Extra:<br>
2 rows in set (0.00 sec)<br>
      <br>
mysql&gt;<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <a
 href="index.html#Exercise_4">return to top of exercise</a><br>
<br>
</div>
<h3 style="margin-left: 40px;" class="tutorial"><a name="4.3"></a>(4.3)
Display the slow query log<br>
</h3>
<div style="margin-left: 40px;"><br>
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">C:\Users\sang&gt;<span
 style="font-weight: bold;">type "C:\ProgramData\MySQL\MySQL Server
5.1\Data\SangShinLaptop-slow.log"</span><br>
C:\Program Files (x86)\MySQL\MySQL Server 5.1\bin\mysqld, Version:
5.1.44-community (MySQL Community<br>
&nbsp;Server (GPL)). started with:<br>
TCP Port: 3306, Named Pipe: MySQL<br>
Time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Id Command&nbsp;&nbsp;&nbsp; Argument<br>
# Time: 100329 15:15:08<br>
# User@Host: root[root] @ localhost [127.0.0.1]<br>
# Query_time: 0.040000&nbsp; Lock_time: 0.000000 Rows_sent: 0&nbsp;
Rows_examined: 0<br>
use mydb;<br>
SET timestamp=1269890108;<br>
DROP TABLE IF EXISTS employees;<br>
# Time: 100329 15:15:09<br>
# User@Host: root[root] @ localhost [127.0.0.1]<br>
# Query_time: 0.030000&nbsp; Lock_time: 0.000000 Rows_sent: 0&nbsp;
Rows_examined: 0<br>
SET timestamp=1269890109;<br>
DROP TABLE IF EXISTS departments;<br>
# User@Host: root[root] @ localhost [127.0.0.1]<br>
# Query_time: 0.100000&nbsp; Lock_time: 0.000000 Rows_sent: 0&nbsp;
Rows_examined: 0<br>
SET timestamp=1269890109;<br>
CREATE TABLE departments (<br>
&nbsp;&nbsp;&nbsp; department_id int(11) NOT NULL AUTO_INCREMENT,<br>
&nbsp;&nbsp;&nbsp; dname varchar(255) NOT NULL,<br>
&nbsp;&nbsp;&nbsp; PRIMARY KEY&nbsp; (department_id)<br>
) ENGINE=InnoDB;<br>
# User@Host: root[root] @ localhost [127.0.0.1]<br>
# Query_time: 0.090000&nbsp; Lock_time: 0.000000 Rows_sent: 0&nbsp;
Rows_examined: 0<br>
SET timestamp=1269890109;<br>
CREATE TABLE employees (<br>
&nbsp;&nbsp;&nbsp; employee_id int(11) NOT NULL AUTO_INCREMENT,<br>
&nbsp;&nbsp;&nbsp; ename varchar(255) NOT NULL,<br>
&nbsp;&nbsp;&nbsp; d_id int(11) NOT NULL,<br>
&nbsp;&nbsp;&nbsp; salary decimal(7,2) NOT NULL,<br>
      <br>
&nbsp;&nbsp;&nbsp; INDEX (ename),<br>
&nbsp;&nbsp;&nbsp; PRIMARY KEY&nbsp; (employee_id),<br>
&nbsp;&nbsp;&nbsp; FOREIGN KEY (d_id) REFERENCES departments
(department_id)<br>
&nbsp;&nbsp;&nbsp; ON DELETE CASCADE<br>
&nbsp;&nbsp;&nbsp; ON UPDATE CASCADE<br>
) ENGINE=InnoDB;<br>
# User@Host: root[root] @ localhost [127.0.0.1]<br>
# Query_time: 0.040000&nbsp; Lock_time: 0.000000 Rows_sent: 0&nbsp;
Rows_examined: 0<br>
SET timestamp=1269890109;<br>
INSERT INTO departments(department_id, dname)<br>
VALUES<br>
(1,'Engineering'),<br>
(2,'Sales'),<br>
(3,'Marketing'),<br>
(4,'HR');<br>
# User@Host: root[root] @ localhost [127.0.0.1]<br>
# Query_time: 0.030000&nbsp; Lock_time: 0.000000 Rows_sent: 0&nbsp;
Rows_examined: 0<br>
SET timestamp=1269890109;<br>
INSERT INTO employees(employee_id, ename, salary, d_id)<br>
VALUES<br>
(1,'jack','3000.00', 1),<br>
(2,'mary','2500.00', 2),<br>
(3,'nichole','4000.00', 1),<br>
(4,'angie','5000.00', 2),<br>
(5,'jones','5000.00', 3);<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">mysql&gt;<span
 style="font-weight: bold;"> SET long_query_time=10.000;</span><br>
Query OK, 0 rows affected (0.00 sec)<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <a
 href="index.html#Exercise_4">return to top of exercise</a><br>
<br>
<br>
<br>
</div>
<h2><a name="Homework_Exercise"></a><a name="Homework"></a>Homework
Exercise (for people
who
are taking Sang Shin's "MySQL online course") <br>
</h2>
<br>
<div style="margin-left: 40px;"><br>
<span style="font-weight: bold;"></span></div>
<div style="margin-left: 40px;">
</div>
<div style="margin-left: 40px;">
<div style="margin-left: 40px;"></div>
</div>
<div style="margin-left: 40px;"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp; <a href="#Tutorial_Exercises">return
to the top</a></div>
<div class="indent"><br>
<br>
<br>
</div>
<br>
<p> </p>
<!-- ======================================================================================== -->
</body>
</html>
